//newsticker
(function(e){function n(e,r){var i=t[r.attr("id")],s=r.children().first().hasClass("webticker-init"),o=e*1e3/i.speed,u={};u[i.direction]=r.css(i.direction).replace("px","").replace("auto","0")-e;r.animate(u,o,"linear",function(){s?r.children().first().remove():r.children().last().after(r.children().first());var e=r.children().first(),t=e.outerWidth(!0);r.css(i.direction,"0");n(t,r)})}function r(t,n,r){var i;e.get(t,function(t){var s=e(t);s.find("item").each(function(){var t=e(this),n={title:t.find("title").text(),link:t.find("link").text()};listItem="<a href='"+n.link+"'>"+n.title+"</a>";i+=listItem});r.webTicker("update",i,n)})}function i(n){var r=t[n.attr("id")];n.width("auto");var i=0;n.children("a").each(function(){i+=e(this).outerWidth(!0)});if(i<n.parent().width()||n.children().length==1)if(r.duplicate){itemWidth=Math.max.apply(Math,n.children().map(function(){return e(this).width()}).get());while(i-itemWidth<n.parent().width()||n.children().length==1){var s=n.children().clone();n.append(s);i=0;n.children("a").each(function(){i+=e(this).outerWidth(!0)});itemWidth=Math.max.apply(Math,n.children().map(function(){return e(this).width()}).get())}}else{var o=n.parent().width()-i;o+=n.find("a:first").width();var u=n.find("a:first").height();n.append('<a class="ticker-spacer" style="width:'+o+"px;height:"+u+'px;"></a>')}if(r.startEmpty)var u=n.find("a:first").height();i=0;n.children("a").each(function(){i+=e(this).outerWidth(!0)});n.width(i+200);widthCompare=0;n.children("a").each(function(){widthCompare+=e(this).outerWidth(!0)});while(widthCompare>=n.width()){n.width(n.width()+200);widthCompare=0;n.children("a").each(function(){widthCompare+=e(this).outerWidth(!0)})}}var t=new Array,s={init:function(e){e=jQuery.extend({speed:50,direction:"left",moving:!0,startEmpty:!0,duplicate:!1,rssurl:!1,hoverpause:!0,rssfrequency:0,updatetype:"reset"},e);t[jQuery(this).attr("id")]=e;return this.each(function(){var s=jQuery(this);s.addClass("newsticker");var o=s.wrap("<div class='mask'></div>");o.after("<span class='tickeroverlay-left'>&nbsp;</span><span class='tickeroverlay-right'>&nbsp;</span>");var u=s.parent().wrap("<div class='tickercontainer'></div>");i(s);if(e.rssurl){r(e.rssurl,e.type,s);e.rssfrequency>0&&window.setInterval(function(){r(e.rssurl,e.type,s)},e.rssfrequency*1e3*60)}var a=s.children().first(),f=a.outerWidth(!0);n(f,s);e.hoverpause&&s.hover(function(){jQuery(this).stop()},function(){if(t[jQuery(this).attr("id")].moving){var r=jQuery(this).offset(),i=s.children().first(),o=i.outerWidth(!0),u;e.direction=="left"?u=parseInt(jQuery(this).css("left").replace("px",""))+o:u=parseInt(jQuery(this).css("right").replace("px",""))+o;n(u,s)}})})},stop:function(){if(t[jQuery(this).attr("id")].moving){t[jQuery(this).attr("id")].moving=!1;return this.each(function(){jQuery(this).stop()})}},cont:function(){if(!t[jQuery(this).attr("id")].moving){t[jQuery(this).attr("id")].moving=!0;var e=t[jQuery(this).attr("id")];return this.each(function(){var t=jQuery(this),r=jQuery(this).offset(),i=t.children().first(),s=i.outerWidth(!0),o;e.direction=="left"?o=parseInt(jQuery(this).css("left").replace("px",""))+s:o=parseInt(jQuery(this).css("right").replace("px",""))+s;n(o,t)})}},update:function(n,r){r=r||"reset";typeof n=="string"&&(n=e(n));var s=jQuery(this);s.webTicker("stop");var o=t[jQuery(this).attr("id")];if(r=="reset"){s.html(n);s.css(o.direction,"0");i(s)}else if(r=="swap"){s.children("a").addClass("old");for(var u=0;u<n.length;u++){match=s.find(n[u]);match.length<1?s.find(".ticker-spacer:first-child").length==0&&s.find(".ticker-spacer").length>0?s.children("a.ticker-spacer").before(n[u]):s.append(n[u]):match.removeClass("old")}s.children("a.webticker-init, a.ticker-spacer").removeClass("old");s.children("a").remove(".old");stripWidth=0;s.children("a").each(function(){stripWidth+=e(this).outerWidth(!0)});s.width(stripWidth+200)}s.webTicker("cont")}};e.fn.webTicker=function(t){if(s[t])return s[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return s.init.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.webTicker")}})(jQuery);
